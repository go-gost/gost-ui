import{g as Nt,u as K,a as Bt,j as l,c as Mt,b as Ze,C as we,A as Rt,L as Dt,d as ie,e as R,f as Pt,q as Ht,h as Re,i as ht,k as be,l as Jt,m as Wt,s as qt,n as Zt,T as Gt,o as Qt,p as Xt}from"./index-aa766c8a.js";import{r as g,A as ce,_ as ue,f as se,k as xe,I as De,d as ee,M as Pe,B as V,F as me,l as gt,S as W,n as Yt,Z as Kt,o as Ct,p as en,h as tn,P as nn,j as bt,T as yt,q as kt,s as jt,E as xt,u as vt,v as wt,D as Lt,w as X,x as sn,y as ln,z as he,G as on,C as z,L as Ae,R as $e,H as an,J as rn,K as cn,N as Ue}from"./antd-029d4367.js";var un={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M699 353h-46.9c-10.2 0-19.9 4.9-25.9 13.3L469 584.3l-71.2-98.8c-6-8.3-15.6-13.3-25.9-13.3H325c-6.5 0-10.3 7.4-6.5 12.7l124.6 172.8a31.8 31.8 0 0051.7 0l210.6-292c3.9-5.3.1-12.7-6.4-12.7z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"check-circle",theme:"outlined"};const dn=un;var fn=function(n,s){return g.createElement(ce,ue({},n,{ref:s,icon:dn}))},mn=g.forwardRef(fn);const He=mn;var pn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M391 240.9c-.8-6.6-8.9-9.4-13.6-4.7l-43.7 43.7L200 146.3a8.03 8.03 0 00-11.3 0l-42.4 42.3a8.03 8.03 0 000 11.3L280 333.6l-43.9 43.9a8.01 8.01 0 004.7 13.6L401 410c5.1.6 9.5-3.7 8.9-8.9L391 240.9zm10.1 373.2L240.8 633c-6.6.8-9.4 8.9-4.7 13.6l43.9 43.9L146.3 824a8.03 8.03 0 000 11.3l42.4 42.3c3.1 3.1 8.2 3.1 11.3 0L333.7 744l43.7 43.7A8.01 8.01 0 00391 783l18.9-160.1c.6-5.1-3.7-9.4-8.8-8.8zm221.8-204.2L783.2 391c6.6-.8 9.4-8.9 4.7-13.6L744 333.6 877.7 200c3.1-3.1 3.1-8.2 0-11.3l-42.4-42.3a8.03 8.03 0 00-11.3 0L690.3 279.9l-43.7-43.7a8.01 8.01 0 00-13.6 4.7L614.1 401c-.6 5.2 3.7 9.5 8.8 8.9zM744 690.4l43.9-43.9a8.01 8.01 0 00-4.7-13.6L623 614c-5.1-.6-9.5 3.7-8.9 8.9L633 783.1c.8 6.6 8.9 9.4 13.6 4.7l43.7-43.7L824 877.7c3.1 3.1 8.2 3.1 11.3 0l42.4-42.3c3.1-3.1 3.1-8.2 0-11.3L744 690.4z"}}]},name:"fullscreen-exit",theme:"outlined"};const hn=pn;var gn=function(n,s){return g.createElement(ce,ue({},n,{ref:s,icon:hn}))},bn=g.forwardRef(gn);const yn=bn;var kn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M290 236.4l43.9-43.9a8.01 8.01 0 00-4.7-13.6L169 160c-5.1-.6-9.5 3.7-8.9 8.9L179 329.1c.8 6.6 8.9 9.4 13.6 4.7l43.7-43.7L370 423.7c3.1 3.1 8.2 3.1 11.3 0l42.4-42.3c3.1-3.1 3.1-8.2 0-11.3L290 236.4zm352.7 187.3c3.1 3.1 8.2 3.1 11.3 0l133.7-133.6 43.7 43.7a8.01 8.01 0 0013.6-4.7L863.9 169c.6-5.1-3.7-9.5-8.9-8.9L694.8 179c-6.6.8-9.4 8.9-4.7 13.6l43.9 43.9L600.3 370a8.03 8.03 0 000 11.3l42.4 42.4zM845 694.9c-.8-6.6-8.9-9.4-13.6-4.7l-43.7 43.7L654 600.3a8.03 8.03 0 00-11.3 0l-42.4 42.3a8.03 8.03 0 000 11.3L734 787.6l-43.9 43.9a8.01 8.01 0 004.7 13.6L855 864c5.1.6 9.5-3.7 8.9-8.9L845 694.9zm-463.7-94.6a8.03 8.03 0 00-11.3 0L236.3 733.9l-43.7-43.7a8.01 8.01 0 00-13.6 4.7L160.1 855c-.6 5.1 3.7 9.5 8.9 8.9L329.2 845c6.6-.8 9.4-8.9 4.7-13.6L290 787.6 423.7 654c3.1-3.1 3.1-8.2 0-11.3l-42.4-42.4z"}}]},name:"fullscreen",theme:"outlined"};const jn=kn;var xn=function(n,s){return g.createElement(ce,ue({},n,{ref:s,icon:jn}))},vn=g.forwardRef(xn);const wn=vn;var Ln={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M893.3 293.3L730.7 130.7c-7.5-7.5-16.7-13-26.7-16V112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V338.5c0-17-6.7-33.2-18.7-45.2zM384 184h256v104H384V184zm456 656H184V184h136v136c0 17.7 14.3 32 32 32h320c17.7 0 32-14.3 32-32V205.8l136 136V840zM512 442c-79.5 0-144 64.5-144 144s64.5 144 144 144 144-64.5 144-144-64.5-144-144-144zm0 224c-44.2 0-80-35.8-80-80s35.8-80 80-80 80 35.8 80 80-35.8 80-80 80z"}}]},name:"save",theme:"outlined"};const Tn=Ln;var On=function(n,s){return g.createElement(ce,ue({},n,{ref:s,icon:Tn}))},An=g.forwardRef(On);const $n=An;var Un={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M924.8 625.7l-65.5-56c3.1-19 4.7-38.4 4.7-57.8s-1.6-38.8-4.7-57.8l65.5-56a32.03 32.03 0 009.3-35.2l-.9-2.6a443.74 443.74 0 00-79.7-137.9l-1.8-2.1a32.12 32.12 0 00-35.1-9.5l-81.3 28.9c-30-24.6-63.5-44-99.7-57.6l-15.7-85a32.05 32.05 0 00-25.8-25.7l-2.7-.5c-52.1-9.4-106.9-9.4-159 0l-2.7.5a32.05 32.05 0 00-25.8 25.7l-15.8 85.4a351.86 351.86 0 00-99 57.4l-81.9-29.1a32 32 0 00-35.1 9.5l-1.8 2.1a446.02 446.02 0 00-79.7 137.9l-.9 2.6c-4.5 12.5-.8 26.5 9.3 35.2l66.3 56.6c-3.1 18.8-4.6 38-4.6 57.1 0 19.2 1.5 38.4 4.6 57.1L99 625.5a32.03 32.03 0 00-9.3 35.2l.9 2.6c18.1 50.4 44.9 96.9 79.7 137.9l1.8 2.1a32.12 32.12 0 0035.1 9.5l81.9-29.1c29.8 24.5 63.1 43.9 99 57.4l15.8 85.4a32.05 32.05 0 0025.8 25.7l2.7.5a449.4 449.4 0 00159 0l2.7-.5a32.05 32.05 0 0025.8-25.7l15.7-85a350 350 0 0099.7-57.6l81.3 28.9a32 32 0 0035.1-9.5l1.8-2.1c34.8-41.1 61.6-87.5 79.7-137.9l.9-2.6c4.5-12.3.8-26.3-9.3-35zM788.3 465.9c2.5 15.1 3.8 30.6 3.8 46.1s-1.3 31-3.8 46.1l-6.6 40.1 74.7 63.9a370.03 370.03 0 01-42.6 73.6L721 702.8l-31.4 25.8c-23.9 19.6-50.5 35-79.3 45.8l-38.1 14.3-17.9 97a377.5 377.5 0 01-85 0l-17.9-97.2-37.8-14.5c-28.5-10.8-55-26.2-78.7-45.7l-31.4-25.9-93.4 33.2c-17-22.9-31.2-47.6-42.6-73.6l75.5-64.5-6.5-40c-2.4-14.9-3.7-30.3-3.7-45.5 0-15.3 1.2-30.6 3.7-45.5l6.5-40-75.5-64.5c11.3-26.1 25.6-50.7 42.6-73.6l93.4 33.2 31.4-25.9c23.7-19.5 50.2-34.9 78.7-45.7l37.9-14.3 17.9-97.2c28.1-3.2 56.8-3.2 85 0l17.9 97 38.1 14.3c28.7 10.8 55.4 26.2 79.3 45.8l31.4 25.8 92.8-32.9c17 22.9 31.2 47.6 42.6 73.6L781.8 426l6.5 39.9zM512 326c-97.2 0-176 78.8-176 176s78.8 176 176 176 176-78.8 176-176-78.8-176-176-176zm79.2 255.2A111.6 111.6 0 01512 614c-29.9 0-58-11.7-79.2-32.8A111.6 111.6 0 01400 502c0-29.9 11.7-58 32.8-79.2C454 401.6 482.1 390 512 390c29.9 0 58 11.6 79.2 32.8A111.6 111.6 0 01624 502c0 29.9-11.7 58-32.8 79.2z"}}]},name:"setting",theme:"outlined"};const Sn=Un;var En=function(n,s){return g.createElement(ce,ue({},n,{ref:s,icon:Sn}))},In=g.forwardRef(En);const _n=In;var Fn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372 0-89 31.3-170.8 83.5-234.8l523.3 523.3C682.8 852.7 601 884 512 884zm288.5-137.2L277.2 223.5C341.2 171.3 423 140 512 140c205.4 0 372 166.6 372 372 0 89-31.3 170.8-83.5 234.8z"}}]},name:"stop",theme:"outlined"};const Vn=Fn;var zn=function(n,s){return g.createElement(ce,ue({},n,{ref:s,icon:Vn}))},Nn=g.forwardRef(zn);const Tt=Nn;function Ot(e,n=!1){const s=e.length;let t=0,i="",o=0,u=16,a=0,r=0,d=0,c=0,m=0;function x(f,w){let y=0,p=0;for(;y<f||!w;){let h=e.charCodeAt(t);if(h>=48&&h<=57)p=p*16+h-48;else if(h>=65&&h<=70)p=p*16+h-65+10;else if(h>=97&&h<=102)p=p*16+h-97+10;else break;t++,y++}return y<f&&(p=-1),p}function L(f){t=f,i="",o=0,u=16,m=0}function k(){let f=t;if(e.charCodeAt(t)===48)t++;else for(t++;t<e.length&&oe(e.charCodeAt(t));)t++;if(t<e.length&&e.charCodeAt(t)===46)if(t++,t<e.length&&oe(e.charCodeAt(t)))for(t++;t<e.length&&oe(e.charCodeAt(t));)t++;else return m=3,e.substring(f,t);let w=t;if(t<e.length&&(e.charCodeAt(t)===69||e.charCodeAt(t)===101))if(t++,(t<e.length&&e.charCodeAt(t)===43||e.charCodeAt(t)===45)&&t++,t<e.length&&oe(e.charCodeAt(t))){for(t++;t<e.length&&oe(e.charCodeAt(t));)t++;w=t}else m=3;return e.substring(f,w)}function j(){let f="",w=t;for(;;){if(t>=s){f+=e.substring(w,t),m=2;break}const y=e.charCodeAt(t);if(y===34){f+=e.substring(w,t),t++;break}if(y===92){if(f+=e.substring(w,t),t++,t>=s){m=2;break}switch(e.charCodeAt(t++)){case 34:f+='"';break;case 92:f+="\\";break;case 47:f+="/";break;case 98:f+="\b";break;case 102:f+="\f";break;case 110:f+=`
`;break;case 114:f+="\r";break;case 116:f+="	";break;case 117:const h=x(4,!0);h>=0?f+=String.fromCharCode(h):m=4;break;default:m=5}w=t;continue}if(y>=0&&y<=31)if(pe(y)){f+=e.substring(w,t),m=2;break}else m=6;t++}return f}function v(){if(i="",m=0,o=t,r=a,c=d,t>=s)return o=s,u=17;let f=e.charCodeAt(t);if(Se(f)){do t++,i+=String.fromCharCode(f),f=e.charCodeAt(t);while(Se(f));return u=15}if(pe(f))return t++,i+=String.fromCharCode(f),f===13&&e.charCodeAt(t)===10&&(t++,i+=`
`),a++,d=t,u=14;switch(f){case 123:return t++,u=1;case 125:return t++,u=2;case 91:return t++,u=3;case 93:return t++,u=4;case 58:return t++,u=6;case 44:return t++,u=5;case 34:return t++,i=j(),u=10;case 47:const w=t-1;if(e.charCodeAt(t+1)===47){for(t+=2;t<s&&!pe(e.charCodeAt(t));)t++;return i=e.substring(w,t),u=12}if(e.charCodeAt(t+1)===42){t+=2;const y=s-1;let p=!1;for(;t<y;){const h=e.charCodeAt(t);if(h===42&&e.charCodeAt(t+1)===47){t+=2,p=!0;break}t++,pe(h)&&(h===13&&e.charCodeAt(t)===10&&t++,a++,d=t)}return p||(t++,m=1),i=e.substring(w,t),u=13}return i+=String.fromCharCode(f),t++,u=16;case 45:if(i+=String.fromCharCode(f),t++,t===s||!oe(e.charCodeAt(t)))return u=16;case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return i+=k(),u=11;default:for(;t<s&&O(f);)t++,f=e.charCodeAt(t);if(o!==t){switch(i=e.substring(o,t),i){case"true":return u=8;case"false":return u=9;case"null":return u=7}return u=16}return i+=String.fromCharCode(f),t++,u=16}}function O(f){if(Se(f)||pe(f))return!1;switch(f){case 125:case 93:case 123:case 91:case 34:case 58:case 44:case 47:return!1}return!0}function U(){let f;do f=v();while(f>=12&&f<=15);return f}return{setPosition:L,getPosition:()=>t,scan:n?U:v,getToken:()=>u,getTokenValue:()=>i,getTokenOffset:()=>o,getTokenLength:()=>t-o,getTokenStartLine:()=>r,getTokenStartCharacter:()=>o-c,getTokenError:()=>m}}function Se(e){return e===32||e===9}function pe(e){return e===10||e===13}function oe(e){return e>=48&&e<=57}var Ge;(function(e){e[e.lineFeed=10]="lineFeed",e[e.carriageReturn=13]="carriageReturn",e[e.space=32]="space",e[e._0=48]="_0",e[e._1=49]="_1",e[e._2=50]="_2",e[e._3=51]="_3",e[e._4=52]="_4",e[e._5=53]="_5",e[e._6=54]="_6",e[e._7=55]="_7",e[e._8=56]="_8",e[e._9=57]="_9",e[e.a=97]="a",e[e.b=98]="b",e[e.c=99]="c",e[e.d=100]="d",e[e.e=101]="e",e[e.f=102]="f",e[e.g=103]="g",e[e.h=104]="h",e[e.i=105]="i",e[e.j=106]="j",e[e.k=107]="k",e[e.l=108]="l",e[e.m=109]="m",e[e.n=110]="n",e[e.o=111]="o",e[e.p=112]="p",e[e.q=113]="q",e[e.r=114]="r",e[e.s=115]="s",e[e.t=116]="t",e[e.u=117]="u",e[e.v=118]="v",e[e.w=119]="w",e[e.x=120]="x",e[e.y=121]="y",e[e.z=122]="z",e[e.A=65]="A",e[e.B=66]="B",e[e.C=67]="C",e[e.D=68]="D",e[e.E=69]="E",e[e.F=70]="F",e[e.G=71]="G",e[e.H=72]="H",e[e.I=73]="I",e[e.J=74]="J",e[e.K=75]="K",e[e.L=76]="L",e[e.M=77]="M",e[e.N=78]="N",e[e.O=79]="O",e[e.P=80]="P",e[e.Q=81]="Q",e[e.R=82]="R",e[e.S=83]="S",e[e.T=84]="T",e[e.U=85]="U",e[e.V=86]="V",e[e.W=87]="W",e[e.X=88]="X",e[e.Y=89]="Y",e[e.Z=90]="Z",e[e.asterisk=42]="asterisk",e[e.backslash=92]="backslash",e[e.closeBrace=125]="closeBrace",e[e.closeBracket=93]="closeBracket",e[e.colon=58]="colon",e[e.comma=44]="comma",e[e.dot=46]="dot",e[e.doubleQuote=34]="doubleQuote",e[e.minus=45]="minus",e[e.openBrace=123]="openBrace",e[e.openBracket=91]="openBracket",e[e.plus=43]="plus",e[e.slash=47]="slash",e[e.formFeed=12]="formFeed",e[e.tab=9]="tab"})(Ge||(Ge={}));const q=new Array(20).fill(0).map((e,n)=>" ".repeat(n)),ae=200,Qe={" ":{"\n":new Array(ae).fill(0).map((e,n)=>`
`+" ".repeat(n)),"\r":new Array(ae).fill(0).map((e,n)=>"\r"+" ".repeat(n)),"\r\n":new Array(ae).fill(0).map((e,n)=>`\r
`+" ".repeat(n))},"	":{"\n":new Array(ae).fill(0).map((e,n)=>`
`+"	".repeat(n)),"\r":new Array(ae).fill(0).map((e,n)=>"\r"+"	".repeat(n)),"\r\n":new Array(ae).fill(0).map((e,n)=>`\r
`+"	".repeat(n))}},Bn=[`
`,"\r",`\r
`];function At(e,n,s){let t,i,o,u,a;if(n){for(u=n.offset,a=u+n.length,o=u;o>0&&!ve(e,o-1);)o--;let y=a;for(;y<e.length&&!ve(e,y);)y++;i=e.substring(o,y),t=Mn(i,s)}else i=e,t=0,o=0,u=0,a=e.length;const r=Rn(s,e),d=Bn.includes(r);let c=0,m=0,x;s.insertSpaces?x=q[s.tabSize||4]??re(q[1],s.tabSize||4):x="	";const L=x==="	"?"	":" ";let k=Ot(i,!1),j=!1;function v(){if(c>1)return re(r,c)+re(x,t+m);const y=x.length*(t+m);return!d||y>Qe[L][r].length?r+re(x,t+m):y<=0?r:Qe[L][r][y]}function O(){let y=k.scan();for(c=0;y===15||y===14;)y===14&&s.keepLines?c+=1:y===14&&(c=1),y=k.scan();return j=y===16||k.getTokenError()!==0,y}const U=[];function f(y,p,h){!j&&(!n||p<a&&h>u)&&e.substring(p,h)!==y&&U.push({offset:p,length:h-p,content:y})}let w=O();if(s.keepLines&&c>0&&f(re(r,c),0,0),w!==17){let y=k.getTokenOffset()+o,p=x.length*t<20&&s.insertSpaces?q[x.length*t]:re(x,t);f(p,o,y)}for(;w!==17;){let y=k.getTokenOffset()+k.getTokenLength()+o,p=O(),h="",$=!1;for(;c===0&&(p===12||p===13);){let F=k.getTokenOffset()+o;f(q[1],y,F),y=k.getTokenOffset()+k.getTokenLength()+o,$=p===12,h=$?v():"",p=O()}if(p===2)w!==1&&m--,s.keepLines&&c>0||!s.keepLines&&w!==1?h=v():s.keepLines&&(h=q[1]);else if(p===4)w!==3&&m--,s.keepLines&&c>0||!s.keepLines&&w!==3?h=v():s.keepLines&&(h=q[1]);else{switch(w){case 3:case 1:m++,s.keepLines&&c>0||!s.keepLines?h=v():h=q[1];break;case 5:s.keepLines&&c>0||!s.keepLines?h=v():h=q[1];break;case 12:h=v();break;case 13:c>0?h=v():$||(h=q[1]);break;case 6:s.keepLines&&c>0?h=v():$||(h=q[1]);break;case 10:s.keepLines&&c>0?h=v():p===6&&!$&&(h="");break;case 7:case 8:case 9:case 11:case 2:case 4:s.keepLines&&c>0?h=v():(p===12||p===13)&&!$?h=q[1]:p!==5&&p!==17&&(j=!0);break;case 16:j=!0;break}c>0&&(p===12||p===13)&&(h=v())}p===17&&(s.keepLines&&c>0?h=v():h=s.insertFinalNewline?r:"");const S=k.getTokenOffset()+o;f(h,y,S),w=p}return U}function re(e,n){let s="";for(let t=0;t<n;t++)s+=e;return s}function Mn(e,n){let s=0,t=0;const i=n.tabSize||4;for(;s<e.length;){let o=e.charAt(s);if(o===q[1])t++;else if(o==="	")t+=i;else break;s++}return Math.floor(t/i)}function Rn(e,n){for(let s=0;s<n.length;s++){const t=n.charAt(s);if(t==="\r")return s+1<n.length&&n.charAt(s+1)===`
`?`\r
`:"\r";if(t===`
`)return`
`}return e&&e.eol||`
`}function ve(e,n){return`\r
`.indexOf(e.charAt(n))!==-1}var ge;(function(e){e.DEFAULT={allowTrailingComma:!1}})(ge||(ge={}));function Dn(e,n=[],s=ge.DEFAULT){let t=null,i=[];const o=[];function u(r){Array.isArray(i)?i.push(r):t!==null&&(i[t]=r)}return Ut(e,{onObjectBegin:()=>{const r={};u(r),o.push(i),i=r,t=null},onObjectProperty:r=>{t=r},onObjectEnd:()=>{i=o.pop()},onArrayBegin:()=>{const r=[];u(r),o.push(i),i=r,t=null},onArrayEnd:()=>{i=o.pop()},onLiteralValue:u,onError:(r,d,c)=>{n.push({error:r,offset:d,length:c})}},s),i[0]}function $t(e,n=[],s=ge.DEFAULT){let t={type:"array",offset:-1,length:-1,children:[],parent:void 0};function i(r){t.type==="property"&&(t.length=r-t.offset,t=t.parent)}function o(r){return t.children.push(r),r}Ut(e,{onObjectBegin:r=>{t=o({type:"object",offset:r,length:-1,parent:t,children:[]})},onObjectProperty:(r,d,c)=>{t=o({type:"property",offset:d,length:-1,parent:t,children:[]}),t.children.push({type:"string",value:r,offset:d,length:c,parent:t})},onObjectEnd:(r,d)=>{i(r+d),t.length=r+d-t.offset,t=t.parent,i(r+d)},onArrayBegin:(r,d)=>{t=o({type:"array",offset:r,length:-1,parent:t,children:[]})},onArrayEnd:(r,d)=>{t.length=r+d-t.offset,t=t.parent,i(r+d)},onLiteralValue:(r,d,c)=>{o({type:Pn(r),offset:d,length:c,parent:t,value:r}),i(d+c)},onSeparator:(r,d,c)=>{t.type==="property"&&(r===":"?t.colonOffset=d:r===","&&i(d))},onError:(r,d,c)=>{n.push({error:r,offset:d,length:c})}},s);const a=t.children[0];return a&&delete a.parent,a}function Fe(e,n){if(!e)return;let s=e;for(let t of n)if(typeof t=="string"){if(s.type!=="object"||!Array.isArray(s.children))return;let i=!1;for(const o of s.children)if(Array.isArray(o.children)&&o.children[0].value===t&&o.children.length===2){s=o.children[1],i=!0;break}if(!i)return}else{const i=t;if(s.type!=="array"||i<0||!Array.isArray(s.children)||i>=s.children.length)return;s=s.children[i]}return s}function Ut(e,n,s=ge.DEFAULT){const t=Ot(e,!1),i=[];function o(b){return b?()=>b(t.getTokenOffset(),t.getTokenLength(),t.getTokenStartLine(),t.getTokenStartCharacter()):()=>!0}function u(b){return b?()=>b(t.getTokenOffset(),t.getTokenLength(),t.getTokenStartLine(),t.getTokenStartCharacter(),()=>i.slice()):()=>!0}function a(b){return b?T=>b(T,t.getTokenOffset(),t.getTokenLength(),t.getTokenStartLine(),t.getTokenStartCharacter()):()=>!0}function r(b){return b?T=>b(T,t.getTokenOffset(),t.getTokenLength(),t.getTokenStartLine(),t.getTokenStartCharacter(),()=>i.slice()):()=>!0}const d=u(n.onObjectBegin),c=r(n.onObjectProperty),m=o(n.onObjectEnd),x=u(n.onArrayBegin),L=o(n.onArrayEnd),k=r(n.onLiteralValue),j=a(n.onSeparator),v=o(n.onComment),O=a(n.onError),U=s&&s.disallowComments,f=s&&s.allowTrailingComma;function w(){for(;;){const b=t.scan();switch(t.getTokenError()){case 4:y(14);break;case 5:y(15);break;case 3:y(13);break;case 1:U||y(11);break;case 2:y(12);break;case 6:y(16);break}switch(b){case 12:case 13:U?y(10):v();break;case 16:y(1);break;case 15:case 14:break;default:return b}}}function y(b,T=[],N=[]){if(O(b),T.length+N.length>0){let E=t.getToken();for(;E!==17;){if(T.indexOf(E)!==-1){w();break}else if(N.indexOf(E)!==-1)break;E=w()}}}function p(b){const T=t.getTokenValue();return b?k(T):(c(T),i.push(T)),w(),!0}function h(){switch(t.getToken()){case 11:const b=t.getTokenValue();let T=Number(b);isNaN(T)&&(y(2),T=0),k(T);break;case 7:k(null);break;case 8:k(!0);break;case 9:k(!1);break;default:return!1}return w(),!0}function $(){return t.getToken()!==10?(y(3,[],[2,5]),!1):(p(!1),t.getToken()===6?(j(":"),w(),A()||y(4,[],[2,5])):y(5,[],[2,5]),i.pop(),!0)}function S(){d(),w();let b=!1;for(;t.getToken()!==2&&t.getToken()!==17;){if(t.getToken()===5){if(b||y(4,[],[]),j(","),w(),t.getToken()===2&&f)break}else b&&y(6,[],[]);$()||y(4,[],[2,5]),b=!0}return m(),t.getToken()!==2?y(7,[2],[]):w(),!0}function F(){x(),w();let b=!0,T=!1;for(;t.getToken()!==4&&t.getToken()!==17;){if(t.getToken()===5){if(T||y(4,[],[]),j(","),w(),t.getToken()===4&&f)break}else T&&y(6,[],[]);b?(i.push(0),b=!1):i[i.length-1]++,A()||y(4,[],[4,5]),T=!0}return L(),b||i.pop(),t.getToken()!==4?y(8,[4],[]):w(),!0}function A(){switch(t.getToken()){case 3:return F();case 1:return S();case 10:return p(!0);default:return h()}}return w(),t.getToken()===17?s.allowEmptyContent?!0:(y(4,[],[]),!1):A()?(t.getToken()!==17&&y(9,[],[]),!0):(y(4,[],[]),!1)}function Pn(e){switch(typeof e){case"boolean":return"boolean";case"number":return"number";case"string":return"string";case"object":{if(e){if(Array.isArray(e))return"array"}else return"null";return"object"}default:return"null"}}function Hn(e,n,s,t){const i=n.slice(),u=$t(e,[]);let a,r;for(;i.length>0&&(r=i.pop(),a=Fe(u,i),a===void 0&&s!==void 0);)typeof r=="string"?s={[r]:s}:s=[s];if(a)if(a.type==="object"&&typeof r=="string"&&Array.isArray(a.children)){const d=Fe(a,[r]);if(d!==void 0)if(s===void 0){if(!d.parent)throw new Error("Malformed AST");const c=a.children.indexOf(d.parent);let m,x=d.parent.offset+d.parent.length;if(c>0){let L=a.children[c-1];m=L.offset+L.length}else m=a.offset+1,a.children.length>1&&(x=a.children[1].offset);return ne(e,{offset:m,length:x-m,content:""},t)}else return ne(e,{offset:d.offset,length:d.length,content:JSON.stringify(s)},t);else{if(s===void 0)return[];const c=`${JSON.stringify(r)}: ${JSON.stringify(s)}`,m=t.getInsertionIndex?t.getInsertionIndex(a.children.map(L=>L.children[0].value)):a.children.length;let x;if(m>0){let L=a.children[m-1];x={offset:L.offset+L.length,length:0,content:","+c}}else a.children.length===0?x={offset:a.offset+1,length:0,content:c}:x={offset:a.offset+1,length:0,content:c+","};return ne(e,x,t)}}else if(a.type==="array"&&typeof r=="number"&&Array.isArray(a.children)){const d=r;if(d===-1){const c=`${JSON.stringify(s)}`;let m;if(a.children.length===0)m={offset:a.offset+1,length:0,content:c};else{const x=a.children[a.children.length-1];m={offset:x.offset+x.length,length:0,content:","+c}}return ne(e,m,t)}else if(s===void 0&&a.children.length>=0){const c=r,m=a.children[c];let x;if(a.children.length===1)x={offset:a.offset+1,length:a.length-2,content:""};else if(a.children.length-1===c){let L=a.children[c-1],k=L.offset+L.length,j=a.offset+a.length;x={offset:k,length:j-2-k,content:""}}else x={offset:m.offset,length:a.children[c+1].offset-m.offset,content:""};return ne(e,x,t)}else if(s!==void 0){let c;const m=`${JSON.stringify(s)}`;if(!t.isArrayInsertion&&a.children.length>r){const x=a.children[r];c={offset:x.offset,length:x.length,content:m}}else if(a.children.length===0||r===0)c={offset:a.offset+1,length:0,content:a.children.length===0?m:m+","};else{const x=r>a.children.length?a.children.length:r,L=a.children[x-1];c={offset:L.offset+L.length,length:0,content:","+m}}return ne(e,c,t)}else throw new Error(`Can not ${s===void 0?"remove":t.isArrayInsertion?"insert":"modify"} Array index ${d} as length is not sufficient`)}else throw new Error(`Can not add ${typeof r!="number"?"index":"property"} to parent of type ${a.type}`);else{if(s===void 0)throw new Error("Can not delete in empty document");return ne(e,{offset:u?u.offset:0,length:u?u.length:0,content:JSON.stringify(s)},t)}}function ne(e,n,s){if(!s.formattingOptions)return[n];let t=Ve(e,n),i=n.offset,o=n.offset+n.content.length;if(n.length===0||n.content.length===0){for(;i>0&&!ve(t,i-1);)i--;for(;o<t.length&&!ve(t,o);)o++}const u=At(t,{offset:i,length:o-i},{...s.formattingOptions,keepLines:!1});for(let r=u.length-1;r>=0;r--){const d=u[r];t=Ve(t,d),i=Math.min(i,d.offset),o=Math.max(o,d.offset+d.length),o+=d.content.length-d.length}const a=e.length-(t.length-o)-i;return[{offset:i,length:a,content:t.substring(i,o)}]}function Ve(e,n){return e.substring(0,n.offset)+n.content+e.substring(n.offset+n.length)}var Xe;(function(e){e[e.None=0]="None",e[e.UnexpectedEndOfComment=1]="UnexpectedEndOfComment",e[e.UnexpectedEndOfString=2]="UnexpectedEndOfString",e[e.UnexpectedEndOfNumber=3]="UnexpectedEndOfNumber",e[e.InvalidUnicode=4]="InvalidUnicode",e[e.InvalidEscapeCharacter=5]="InvalidEscapeCharacter",e[e.InvalidCharacter=6]="InvalidCharacter"})(Xe||(Xe={}));var Ye;(function(e){e[e.OpenBraceToken=1]="OpenBraceToken",e[e.CloseBraceToken=2]="CloseBraceToken",e[e.OpenBracketToken=3]="OpenBracketToken",e[e.CloseBracketToken=4]="CloseBracketToken",e[e.CommaToken=5]="CommaToken",e[e.ColonToken=6]="ColonToken",e[e.NullKeyword=7]="NullKeyword",e[e.TrueKeyword=8]="TrueKeyword",e[e.FalseKeyword=9]="FalseKeyword",e[e.StringLiteral=10]="StringLiteral",e[e.NumericLiteral=11]="NumericLiteral",e[e.LineCommentTrivia=12]="LineCommentTrivia",e[e.BlockCommentTrivia=13]="BlockCommentTrivia",e[e.LineBreakTrivia=14]="LineBreakTrivia",e[e.Trivia=15]="Trivia",e[e.Unknown=16]="Unknown",e[e.EOF=17]="EOF"})(Ye||(Ye={}));const Jn=Dn,Wn=$t,qn=Fe;var Ke;(function(e){e[e.InvalidSymbol=1]="InvalidSymbol",e[e.InvalidNumberFormat=2]="InvalidNumberFormat",e[e.PropertyNameExpected=3]="PropertyNameExpected",e[e.ValueExpected=4]="ValueExpected",e[e.ColonExpected=5]="ColonExpected",e[e.CommaExpected=6]="CommaExpected",e[e.CloseBraceExpected=7]="CloseBraceExpected",e[e.CloseBracketExpected=8]="CloseBracketExpected",e[e.EndOfFileExpected=9]="EndOfFileExpected",e[e.InvalidCommentToken=10]="InvalidCommentToken",e[e.UnexpectedEndOfComment=11]="UnexpectedEndOfComment",e[e.UnexpectedEndOfString=12]="UnexpectedEndOfString",e[e.UnexpectedEndOfNumber=13]="UnexpectedEndOfNumber",e[e.InvalidUnicode=14]="InvalidUnicode",e[e.InvalidEscapeCharacter=15]="InvalidEscapeCharacter",e[e.InvalidCharacter=16]="InvalidCharacter"})(Ke||(Ke={}));function Zn(e,n,s){return At(e,n,s)}function ke(e,n,s,t){return Hn(e,n,s,t)}function Je(e,n){let s=n.slice(0).sort((i,o)=>{const u=i.offset-o.offset;return u===0?i.length-o.length:u}),t=e.length;for(let i=s.length-1;i>=0;i--){let o=s[i];if(o.offset+o.length<=t)e=Ve(e,o);else throw new Error("Overlapping edit");t=o.offset}return e}const Gn=["_id_","_key_","_type_"],ze=e=>JSON.stringify(e,null,4),te=e=>{const n={...e};for(const s of Gn)delete n[s];return ze(n)},Qn=e=>Je(e,Zn(e,void 0,{tabSize:4,insertSpaces:!0})),Y=e=>{const n=[],s=Jn(e,n,{allowTrailingComma:!0});if(n.length)throw console.error(n),n[0];return s},Xn=(e,n)=>{const s=[],t=ke.bind(null,e);return n.forEach(({path:i,value:o,options:u},a)=>{i=Array.isArray(i)?i:i.split("."),s.push(...t(i,o,u||{}))}),Je(e,s)},Yn=(e,n)=>{const s=URL.createObjectURL(new Blob([e])),t=document.createElement("a");t.download=n,t.href=s,t.click(),URL.revokeObjectURL(s)};function Ne(e,n,s){const t=e!==void 0,i=n!==void 0,[o,u]=g.useState(t?e:i?n:s),a=g.useRef({value:o,setValue:d=>{let c;typeof d=="function"?c=d(a.current.value):c=d,a.current.value=c,u(c)}});return[g.useMemo(()=>{const c=e!==void 0?e:o;return a.current.value=c,c},[e,o]),a.current.setValue]}const Kn={zh:"zh-cn",en:""};(function(){const e=window.require;if(e){const n=Nt();e.config({"vs/nls":{availableLanguages:{"*":Kn[n.resolvedLanguage]??""}}})}window.monacoIsReady=new Promise((n,s)=>{if(!e)return s("Not loaded monaco loader.js");e(["vs/editor/editor.main"],function(){n(monaco)})})})();monacoIsReady.then(()=>{monaco.languages.json.jsonDefaults.setDiagnosticsOptions({allowComments:!0,trailingCommas:"warning",validate:!0})});const Cn={minimap:{enabled:!1},automaticLayout:!0},es=(e,n)=>{const{onChange:s,options:t,height:i,className:o,theme:u,style:a}=e,{t:r}=K(),[d,c]=Ne(e.language,"javascript"),[m,x]=Ne(e.value,e.defaultValue,""),[L,k]=g.useState(!1),[j,v]=g.useState(),O=g.useRef(null),U=g.useRef(null),f=g.useRef({}),w=Bt(),y=g.useMemo(()=>u||(w?"vs-dark":"vs"),[u,w]);return se.useImperativeHandle(n,()=>j,[j]),se.useImperativeHandle(U,()=>j,[j]),se.useImperativeHandle(f,()=>({onChange:s,editor:j,options:t}),[s,j,t]),g.useEffect(()=>{monacoIsReady.then(()=>{k(!0)})},[]),g.useEffect(()=>{if(L&&O.current){const p=O.current,h=monaco.editor.create(p,{value:m,language:d,theme:y,...Cn,...t});return v(h),h.onDidChangeModelContent(function($){var F,A;const S=h.getValue();x(S),(A=(F=f.current)==null?void 0:F.onChange)==null||A.call(F,S)}),h.addCommand(monaco.KeyMod.Alt|monaco.KeyCode.KeyX,$=>{var S;(S=h.getAction("my-autoWrap-toggle"))==null||S.run()}),h.addAction({id:"my-autoWrap-toggle",label:r("msg.wordWrap"),keybindings:[monaco.KeyMod.Alt|monaco.KeyCode.KeyZ],run:function($,S){const F=$.getOption(monaco.editor.EditorOption.wordWrap);$.updateOptions({wordWrap:F==="on"?"off":"on"})}}),()=>{var $;($=h==null?void 0:h.dispose)==null||$.call(h)}}},[L]),g.useEffect(()=>{var p,h,$;if((p=f.current)!=null&&p.editor){const S=f.current.editor;m!=S.getValue()&&(($=(h=f.current)==null?void 0:h.options)!=null&&$.readOnly?S.setValue(m):S.executeEdits(null,[{range:S.getModel().getFullModelRange(),text:m,forceMoveMarkers:!1}]))}},[m]),L?l.jsx("div",{className:xe(o),style:{height:i||"100%",minHeight:0,minWidth:0,boxSizing:"border-box",...a},ref:O}):l.jsx(De.TextArea,{style:{height:i||"100%"},className:xe(o),value:m,onChange:p=>{var $,S;const h=p.target.value;x(h),(S=($=f.current)==null?void 0:$.onChange)==null||S.call($,h)}})},St=se.forwardRef(es),ts=e=>{const{onFinish:n,trigger:s,open:t,onOpenChange:i,modalProps:o,title:u,width:a,formRef:r,children:d,isFull:c,...m}=e,[x,L]=Ne(t,!1),[k]=ee.useForm(),j=g.useCallback(()=>{var f;L(!1),i==null||i(!1),(f=o==null?void 0:o.onCancel)==null||f.call(o,{})},[i]),v=g.useCallback(()=>{var f;k.resetFields(),(f=o==null?void 0:o.afterClose)==null||f.call(o)},[k,o]),O=g.useMemo(()=>async function(f){await(n==null?void 0:n.apply(null,[f]))===!0&&j()},[n,j]),U=g.useMemo(()=>{const f=xe(o==null?void 0:o.className,{"full-modal":c});return{...o,className:f,onCancel:j,onOk:()=>{k.submit()},afterClose:v,open:x,title:u,width:a}},[v,k,o,j,x,u,a,c]);return g.useEffect(()=>{if(!r)return;switch(typeof r){case"function":r(k);break;case"object":r.current=k;break}},[k,r]),l.jsxs(l.Fragment,{children:[l.jsx(Pe,{mask:!0,maskClosable:!1,...U,children:l.jsx(ee,{form:k,onFinish:O,...m,children:d})}),s&&se.cloneElement(s,{onClick:()=>{L(!0)}})]})};let ye;const ns=new Uint8Array(16);function ss(){if(!ye&&(ye=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!ye))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return ye(ns)}const M=[];for(let e=0;e<256;++e)M.push((e+256).toString(16).slice(1));function ls(e,n=0){return M[e[n+0]]+M[e[n+1]]+M[e[n+2]]+M[e[n+3]]+"-"+M[e[n+4]]+M[e[n+5]]+"-"+M[e[n+6]]+M[e[n+7]]+"-"+M[e[n+8]]+M[e[n+9]]+"-"+M[e[n+10]]+M[e[n+11]]+M[e[n+12]]+M[e[n+13]]+M[e[n+14]]+M[e[n+15]]}const is=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Ce={randomUUID:is};function os(e,n,s){if(Ce.randomUUID&&!n&&!e)return Ce.randomUUID();e=e||{};const t=e.random||(e.rng||ss)();if(t[6]=t[6]&15|64,t[8]=t[8]&63|128,n){s=s||0;for(let i=0;i<16;++i)n[s+i]=t[i];return n}return ls(t)}const Et=e=>{const{children:n,label:s,...t}=e,{json:i,cli:o}=e,u=os();if(n)return{key:u,...t,label:Ze(s),children:n.map(Et)};if(i)return{key:u,...t,label:Ze(s),title:o}},le=e=>{const{templates:n,modalProps:s,...t}=e,{t:i}=K(),o=g.useRef(),u=g.useRef(null),[a,r]=g.useState(!1),d=L=>{var j,v,O;let k=L;if((j=e.initialValues)!=null&&j.value){const U=Y(e.initialValues.value);k=U.name?Xn(L,[{path:"name",value:U.name}]):L}k=Qn(k),(v=o.current)==null||v.setFieldValue("value",k),(O=o.current)==null||O.validateFields()},c=g.useMemo(()=>n==null?void 0:n.map(Et),[n]),m=g.useCallback(L=>{var k,j;console.log("editorRef",u),(j=(k=u.current)==null?void 0:k.getAction(L))==null||j.run()},[]),x=n==null?void 0:n.length;return l.jsx(l.Fragment,{children:l.jsx(ts,{...t,isFull:a,formRef:o,modalProps:{destroyOnClose:!0,maskClosable:!1,...s,footer:(L,{OkBtn:k,CancelBtn:j})=>l.jsxs(l.Fragment,{children:[l.jsx(V,{onClick:()=>{var v;return(v=o.current)==null?void 0:v.resetFields()},children:i("base.cmd.reset")}),l.jsx(j,{}),l.jsx(k,{})]})},children:l.jsxs(me,{style:{height:"100%"},vertical:!0,children:[l.jsxs(me,{style:{paddingBottom:5},justify:"space-between",align:"center",children:[l.jsx(me,{gap:"small",children:x?l.jsx(gt,{menu:{items:c,onClick:function(L){var v;const j=(v=L.keyPath.reverse().reduce((O,U)=>{var f;if(Array.isArray(O))return O==null?void 0:O.find(w=>w.key===U);if(O.children)return(f=O.children)==null?void 0:f.find(w=>w.key===U)},c))==null?void 0:v.json;j&&d(j)}},children:l.jsx(V,{type:"link",size:"small",children:l.jsxs(W,{children:[i("terms.template"),l.jsx(Yt,{})]})})}):null}),l.jsx(me,{gap:"small",children:l.jsxs(W.Compact,{size:"small",children:[l.jsx(V,{icon:l.jsx(Kt,{}),onClick:()=>m("editor.action.fontZoomOut")}),l.jsx(V,{icon:l.jsx(Ct,{}),onClick:()=>m("editor.action.fontZoomIn")}),l.jsx(V,{icon:a?l.jsx(yn,{}):l.jsx(wn,{}),onClick:()=>r(L=>!L)})]})})]}),l.jsx(me,{flex:"100%",vertical:!0,children:l.jsx(ee.Item,{noStyle:!0,name:"value",children:l.jsx(St,{ref:u,className:"g-boder",height:a?"100%":300,language:"json",options:{minimap:{enabled:!1}}})})}),l.jsx(ee.Item,{className:"form-only-error",name:"value",rules:[{required:!0,message:i("msg.require")},{validator:(L,k)=>new Promise((j,v)=>{k&&Y(k),j(null)}).catch(j=>{throw console.error(j),new Error(i("msg.formatError",{name:"JSON"}))})}]})]})})})};le.show=e=>{const{onOpenChange:n,open:s,...t}=e;let i;const o=document.createDocumentFragment(),u=Mt.createRoot(o);function a({...d}){clearTimeout(i);const c=en();i=setTimeout(()=>{document.body.append(o),u.render(l.jsx(tn,{theme:c.getTheme(),children:l.jsx(le,{...d})}))},100)}function r(){u.unmount(),document.body.removeChild(o)}a({...t,open:!0,onOpenChange:d=>{!d&&r()}})};const It=`{
    "services": [
        {
            "name": "service-0",
            "addr": ":8080",
            // "interface": "eth0",
            // "admission": "admission-0",
            // "bypass": "bypass-0",
            // "resolver": "resolver-0",
            // "hosts": "hosts-0",
            "handler": {
                "type": "auto",
                // "auth": {
                //     "username": "gost",
                //     "password": "gost"
                // },
                // "auther": "auther-0",
                // "retries": 1,
                // "chain": "chain-0",
                // "metadata": {
                //     "bar": "baz",
                //     "foo": "bar"
                // }
            },
            "listener": {
                "type": "tcp",
                // "auth": {
                //     "username": "user",
                //     "password": "pass"
                // },
                // "auther": "auther-0",
                // "chain": "chain-0",
                // "tls": {
                //     "certFile": "cert.pem",
                //     "keyFile": "key.pem",
                //     "caFile": "ca.pem"
                // },
                // "metadata": {
                //     "abc": "xyz",
                //     "def": 456
                // }
            },
            // "forwarder": {
            //     "nodes": [
            //         {
            //             "name": "target-0",
            //             "addr": "192.168.1.1:1234"
            //         },
            //         {
            //             "name": "target-1",
            //             "addr": "192.168.1.2:2345"
            //         }
            //     ],
            //     "selector": {
            //         "strategy": "round",
            //         "maxFails": 1,
            //         "failTimeout": 30
            //     }
            // }
        }
    ],
    "chains": [
        {
            "name": "chain-0",
            // "selector": {
            //     "strategy": "round",
            //     "maxFails": 1,
            //     "failTimeout": 30
            // },
            "hops": [
                {
                    "name": "hop-0",
                    // "interface": "192.168.1.2",
                    // "selector": {
                    //     "strategy": "rand",
                    //     "maxFails": 3,
                    //     "failTimeout": 60
                    // },
                    // "bypass": "bypass-0",
                    "nodes": [
                        {
                            "name": "node-0",
                            "addr": ":1080",
                            // "interface": "eth1",
                            // "bypass": "bypass-0",
                            "connector": {
                                "type": "socks5",
                                "auth": {
                                    "username": "user",
                                    "password": "pass"
                                },
                                // "metadata": {
                                //     "foo": "bar"
                                // }
                            },
                            "dialer": {
                                "type": "tcp",
                                // "auth": {
                                //     "username": "user",
                                //     "password": "pass"
                                // },
                                // "tls": {
                                //     "caFile": "ca.pem",
                                //     "secure": true,
                                //     "serverName": "example.com"
                                // },
                                // "metadata": {
                                //     "bar": "baz"
                                // }
                            }
                        }
                    ]
                }
            ]
        }
    ],
    "authers": [
        {
            "name": "auther-0",
            "auths": [
                {
                    "username": "user1",
                    "password": "pass1"
                },
                {
                    "username": "user2",
                    "password": "pass2"
                }
            ]
        }
    ],
    "admissions": [
        {
            "name": "admission-0",
            "whitelist": false,
            "matchers": [
                "127.0.0.1",
                "192.168.0.0/16"
            ]
        }
    ],
    "bypasses": [
        {
            "name": "bypass-0",
            "whitelist": false,
            "matchers": [
                "*.example.com",
                ".example.org",
                "0.0.0.0/8"
            ]
        }
    ],
    "resolvers": [
        {
            "name": "resolver-0",
            "nameservers": [
                {
                    "addr": "udp://8.8.8.8:53",
                    "chain": "chain-0",
                    "prefer": "ipv4",
                    "clientIP": "1.2.3.4",
                    "ttl": 60,
                    "timeout": 30
                },
                {
                    "addr": "tcp://1.1.1.1:53"
                },
                {
                    "addr": "tls://1.1.1.1:853"
                },
                {
                    "addr": "https://1.0.0.1/dns-query",
                    "hostname": "cloudflare-dns.com"
                }
            ]
        }
    ],
    "hosts": [
        {
            "name": "hosts-0",
            "mappings": [
                {
                    "ip": "127.0.0.1",
                    "hostname": "localhost"
                },
                {
                    "ip": "192.168.1.10",
                    "hostname": "foo.mydomain.org",
                    "aliases": [
                        "foo"
                    ]
                },
                {
                    "ip": "192.168.1.13",
                    "hostname": "bar.mydomain.org",
                    "aliases": [
                        "bar",
                        "baz"
                    ]
                }
            ]
        }
    ],
    "tls": {
        "certFile": "cert.pem",
        "keyFile": "key.pem",
        "caFile": "ca.pem"
    },
    "log": {
        "output": "stderr",
        "level": "debug",
        "format": "json",
        "rotation": {
            "maxSize": 100,
            "maxAge": 10,
            "maxBackups": 3,
            "localTime": false,
            "compress": false
        }
    },
    "profiling": {
        "addr": ":6060",
        "enabled": true
    },
    "api": {
        "addr": ":18080",
        "pathPrefix": "/api",
        "accesslog": true,
        "auth": {
            "username": "user",
            "password": "password"
        },
        "auther": "auther-0"
    },
    "metrics": {
        "addr": ":9000",
        "path": "/metrics"
    }
}`,as={en:"Default",zh:"默认"},rs={admissions:"https://gost.run/concepts/admission/",authers:"https://gost.run/concepts/auth/",bypasses:"https://gost.run/concepts/bypass/",chains:"https://gost.run/concepts/chain/",hops:"https://gost.run/concepts/hop/",hosts:"https://gost.run/concepts/hosts/",ingresses:"https://gost.run/concepts/ingress/",observers:"https://gost.run/concepts/observer/",resolvers:"https://gost.run/concepts/resolver/",limiters:"https://gost.run/concepts/limiter/",rlimiter:"https://gost.run/concepts/limiter/",climiter:"https://gost.run/concepts/limiter/",routers:"https://gost.run/concepts/router/",sds:"https://gost.run/concepts/sd/",services:"https://gost.run/concepts/service/"},cs=[],et=Wn(It,cs,{allowTrailingComma:!0}),us=e=>{if(!et)return;const n=qn(et,[e,0]);if(n){const{offset:s,length:t}=n;return It.substring(s,s+t)}},P=(e,n=as)=>{const s=us(e),t=rs[e],i="// "+t+`
`;let o;return s&&(o={label:n,json:i+s}),{def:o,docUrl:t,_docUrl:i}},ds=e=>`{
    "name": "${e}-0",
    "file": {
      "path": "/path/to/file"
    }
  }`,fs=(e,n)=>`{
    "name": "${e}-0",
    "redis": {
      "addr": "127.0.0.1:6379",
      "db": "1",
      "password": "123456",
      ${n?`"type": "${n}",`:""}
      "key": "gost:${e}-0"
    }
  }`,ms=e=>`{
    "name": "${e}-0",
    "http": {
      "url": "http://127.0.0.1:8000",
      "timeout": "10s"
    }
  }`,_t=e=>`{
    "name": "${e}-0",
    "plugin": {
      "type": "grpc",
      // "type": "http",
      "addr": "127.0.0.1:8000",
      "token": "gost",
      // "tls": {}
    }
  }`,C=(e,n="",s)=>{const t=n?`// ${n} 
`:"";return[{label:"File",json:t+ds(e)},{label:"Redis",json:t+fs(e,s==null?void 0:s.redisType)},{label:"HTTP",json:t+ms(e)},{label:"Plugin",json:t+_t(e)}]},{def:tt,docUrl:ps,_docUrl:hs}=P("admissions"),gs=[tt||{label:{zh:"内联",en:"Inline"},json:hs+`
      {
        "name": "admission-0",
        "matchers": [
          "127.0.0.1",
          "192.168.0.0/16",
          "example.com"
        ]
      }`},...C("admission",ps)],{def:bs,docUrl:ys}=P("authers"),ks=[bs,...C("auther",ys)],{def:js,docUrl:wl,_docUrl:xs}=P("chains"),vs=[js,{label:{zh:"典型转发链",en:"Typical"},cli:"",json:xs+`
{
  "name": "chain-0",
  "hops": [
    {
      "name": "hop-0",
      "nodes": [
        {
          "name": "node-0",
          "addr": "proxy.xxx.com:1080",
          "connector": {
            "type": "socks5",
            "auth": {
              "username": "username",
              "password": "password"
            }
          },
          "dialer": {
            "type": "tcp",
            "tls": {
              "serverName": "proxy.xxx.com"
            }
          }
        }
      ]
    }
  ]
}
      `}],{def:nt,docUrl:ws,_docUrl:Ls}=P("bypasses"),Ts=[nt||{label:{zh:"内联",en:"Inline"},json:Ls+`
      {
        "name": "bypass-0",
        "matchers": [
          "127.0.0.1",
          "172.10.0.0/16",
          "localhost",
          "*.example.com",
          ".example.org"
        ]
      }`},...C("bypass",ws)],{def:st,docUrl:Os,_docUrl:As}=P("hops"),$s=[st||{label:{zh:"内联",en:"Inline"},json:As+`
    {
      "name": "hop-0",
      "nodes": [
        {
          "name": "node-0",
          "addr": ":8888",
          "connector": {
            "type": "http"
          },
          "dialer": {
            "type": "tcp"
          }
        },
        {
          "name": "node-1",
          "addr": ":9999",
          "connector": {
            "type": "socks5"
          },
          "dialer": {
            "type": "tcp"
          }
        }
      ]
    }`},...C("hop",Os)],{def:lt,docUrl:Us,_docUrl:Ss}=P("hosts"),Es=[lt||{label:{zh:"内联",en:"Inline"},json:Ss+`
{
  "name": "hosts-0",
  "mappings": [
    {
      "ip": "127.0.0.1",
      "hostname": "example.com"
    },
    {
      "ip": "2001:db8::1",
      "hostname": "example.com"
    }
  ]
}`},...C("hosts",Us)],{def:it,docUrl:Is,_docUrl:_s}=P("ingresses"),Fs=[it||{label:{zh:"内联",en:"Inline"},json:_s+`{
        "name": "ingress-0",
        "rules": [
          {
            "hostname": "example.com",
            "endpoint": "4d21094e-b74c-4916-86c1-d9fa36ea677b"
          },
          {
            "hostname": "example.org",
            "endpoint": "ac74d9dd-3125-442a-a7c1-f9e49e05faca"
          }
        ]
      }`},...C("ingress",Is,{redisType:"hash"})],{def:ot,docUrl:Vs,_docUrl:zs}=P("routers"),Ns=[ot||{label:{zh:"内联",en:"Inline"},json:zs+`
      {
        "name": "router-0",
        "routes": [
          {
            "net": "192.168.1.0/24",
            "gateway": "192.168.123.2"
          },
          {
            "net": "172.10.0.0/16",
            "gateway": "192.168.123.3"
          }
        ]
      }`},...C("router",Vs)],{def:Bs,docUrl:Ll,_docUrl:je}=P("services"),G=(e,n,s)=>{let t=je+`
  {
    "name": "service-0",
    "addr": ":1080",
    "handler": {
      "type": "${e}",
      // "auth": {
      //   "username": "user",
      //   "password": "password"
      // }
    },
    "listener": {
      "type": "${n}"
    }
  }`;if(s){const i=ke(t,["metadata"],s,{});i.push(...ke(t,["handler","metadata"],s,{})),i.push(...ke(t,["listener","metadata"],s,{})),t=Je(t,i)}return t},Ms=[Bs,{label:{zh:"端口转发",en:"Port Forwarding"},cli:"-L tcp://:80/:8080",json:je+`
      {
        "name": "service-0",
        "addr": ":80",
        "handler": {
          "type": "tcp"
        },
        "listener": {
          "type": "tcp"
        },
        "forwarder": {
          "nodes": [
            {
              "name": "target-0",
              "addr": ":8080"
            }
          ]
        }
      }`},{label:{zh:"反向代理",en:"Reverse Proxy"},cli:"",json:je+`
      {
        "name": "service-0",
        "addr": ":80",
        "handler": {
            "type": "tcp",
            "metadata": {
                "sniffing": "true"
            }
        },
        "listener": {
            "type": "tcp"
        },
        "forwarder": {
            "nodes": [
                {
                    "name": "target-1",
                    "addr": "www.baidu.com:80",
                    // "host": "myhost.com",
                    // "path": "/"
                    "http": {
                        "host": "www.baidu.com"
                    }
                }
            ]
        }
      }`},{label:{zh:"代理服务",en:"Proxy Service"},children:[{label:"http",children:[{label:"http",json:G("http","tcp")},{label:"https(http+tsl)",json:G("http","tls")},{label:"http+wss",json:G("http","wss")},{label:"http2",json:G("http2","http2")}]},{label:"relay",children:[{label:"relay+tcp",json:G("relay","tcp")},{label:"relay+tls",json:G("relay","tls")},{label:"relay+wss",json:G("relay","tls")}]},{label:"socks",children:[{label:"socks4",json:G("socks","tcp")},{label:"socks5",json:G("socks5","tcp")},{label:"socks5(udp)",json:G("socks5","tcp",{udp:"true"})},{label:"socks5+tls",json:G("socks5","tls",{notls:"true"})}]}]},{label:{zh:"代理转发",en:"Porxy Forwarding"},cli:"-L socks5://:1080 -F socks5://xxx.com:1080",json:je+`
      {
        "name": "service-0",
        "addr": ":1080",
        "handler": {
          "type": "socks5",
          "chain": "chain-0"
        },
        "listener": {
          "type": "tcp"
        }
      }`}],{def:at,docUrl:Rs,_docUrl:Ds}=P("climiter"),Ps=[at||{label:{zh:"内联",en:"Inline"},json:Ds+`
    {
      "name": "climiter-0",
      "limits": [
        "$ 1000",
        "$$ 100",
        "192.168.1.1  10"
      ]
    }`},...C("climiter",Rs,{redisType:"set"})],{def:rt,docUrl:Hs,_docUrl:Js}=P("limiters"),Ws=[rt||{label:{zh:"内联",en:"Inline"},json:Js+`
    {
      "name": "limiter-0",
      "limits": [
        "$ 100MB 100MB",
        "$$ 10MB",
        "192.168.1.1  512KB 1MB",
        "192.168.0.0/16  1MB  5MB"
      ]
    }`},...C("limiters",Hs,{redisType:"set"})],{def:ct,docUrl:qs,_docUrl:Zs}=P("rlimiter"),Gs=[ct||{label:{zh:"内联",en:"Inline"},json:Zs+`
    {
      "name": "rlimiter-0",
      "limits": [
        "$ 100",
        "$$ 10",
        "192.168.1.1  50",
        "192.168.0.0/16  5"
      ]
    }`},...C("rlimiter",qs,{redisType:"set"})],{def:Qs,docUrl:Tl,_docUrl:Xs}=P("resolvers"),Ys=[Qs,{label:"Plugin",json:Xs+_t("resolver")}],{def:ut,docUrl:Ol,_docUrl:Ks}=P("sds"),Cs=[ut||{label:"HTTP Plugin",json:Ks+`
      // https://gost.run/concepts/sd/
      {
        "name": "sd-0",
        "plugin": {
          "type": "http",
          "addr": "http://127.0.0.1:8000/sd",
          // "token": "gost",
          // "tls": {}
        }
      }`}],{def:dt,docUrl:Al,_docUrl:el}=P("observers"),tl=[dt||{label:"Plugin",json:el+`
      {
        "name": "observer-0",
        "plugin": {
          "type": "grpc",
          // "type": "http",
          "addr": "127.0.0.1:8000",
          "token": "gost",
          // "tls": {}
        }
      }`}],nl={admissions:gs,authers:ks,bypasses:Ts,chains:vs,climiters:Ps,limiters:Ws,rlimiters:Gs,hops:$s,hosts:Es,ingresses:Fs,resolvers:Ys,routers:Ns,sds:Cs,observers:tl,services:Ms},We=e=>{const{name:n}=e;return g.useMemo(()=>nl[n],[n])},qe=e=>{const{name:n,localApi:s,gostConfig:t,localConfig:i}=e,o=g.useMemo(()=>(t==null?void 0:t[n])||[],[t,n]),u=g.useMemo(()=>s?(i==null?void 0:i[n])||[]:[],[i,n,s]),a=g.useMemo(()=>[...o,...u],[o,u]);return{dataList:o,dataSource:a}},sl=e=>{const{t:n}=K(),{keyName:s,title:t}=e,{comm:i}=g.useContext(we),o=We({name:s}),u={title:n("title.add",{name:t}),templates:o,onFinish:async a=>{const{value:r}=a,d=Y(r);return await i.addValue(d),!0}};return l.jsx(V,{icon:l.jsx(nn,{}),size:"small",onClick:()=>{le.show(u)}})},H=e=>({keyName:e,api:Rt[e],localApi:Dt[e],rowKey:"name"}),ll=[{name:"admission",title:"准入控制器(Admission)",subTitle:"准入控制器",...H("admissions")},{name:"auther",title:"认证器(Auther)",subTitle:"认证器",...H("authers")},{name:"bypass",title:"分流器(Bypass)",subTitle:"分流器",...H("bypasses")},{name:"chain",title:"转发链(Chain)",subTitle:"转发链",...H("chains")},{name:"climiter",title:"并发连接数限制",subTitle:"",...H("climiters")},{name:"limiter",title:"流量速率限制",subTitle:"",...H("limiters")},{name:"rlimiter",title:"请求速率限制",subTitle:"",...H("rlimiters")},{name:"hop",title:"跳跃点(Hop)",subTitle:"跳跃点",...H("hops")},{name:"host",title:"主机映射器(Hosts)",subTitle:"主机映射器",...H("hosts")},{name:"ingress",title:"Ingress",subTitle:"Ingress",...H("ingresses")},{name:"resolver",title:"域名解析器(Resolver)",subTitle:"域名解析器",...H("resolvers")},{name:"service",title:"服务(Service)",subTitle:"服务",...H("services")},{name:"sd",title:"服务发现(SD)",subTitle:"服务发现",...H("sds")},{name:"observer",title:"观测器(Observer)",subTitle:"观测器",...H("observers")}],il=e=>ll.find(n=>n.name===e),Ee=le.show,de=se.createContext({}),ft=(e,n,s)=>JSON.stringify(n),ol=(e,n)=>{var s,t;return((t=(s=e==null?void 0:e.name)==null?void 0:s.toLowerCase())==null?void 0:t.indexOf(n))!==-1},al=e=>{const{name:n,title:s,api:t,localApi:i,keyName:o,rowKey:u="name",keyword:a,renderConfig:r=ft,filter:d=ol}=e,{t:c}=K(),{localList:m,comm:x}=g.useContext(we),{gostConfig:L,localConfig:k}=g.useContext(ie),{dataList:j,dataSource:v}=qe({localApi:i,name:o,gostConfig:L,localConfig:k}),O=We({name:o});bt.useApp();const{deleteValue:U,updateValue:f,disable:w,enable:y,updateLocal:p,deleteLocal:h,addValue:$}=x,S=g.useRef({dataList:j,dataSource:v});g.useImperativeHandle(S,()=>({dataList:j,dataSource:v}),[j,v]);const F=g.useMemo(()=>a?v.filter(A=>d(A,a)):v,[v,d,a]);return g.useEffect(()=>{function A({path:b,record:T}){const{dataList:N,dataSource:E}=S.current,_=N.includes(T),I=T.name,B=b.split(","),Le=B.reduce((D,Z)=>D==null?void 0:D[Z],T),Te=D=>{let Z=T;B.forEach((fe,Oe)=>{Oe===B.length-1?Z[fe]=D:Z=Z[fe]})};Ee({title:c("base.cmd.edit"),initialValues:{value:te(Le)},onFinish:async D=>(Te(Y(D.value)),_?await f(I,T):await p(I,T),!0)})}return R.on(`edit:${n}`,A),()=>{R.off(`edit:${n}`,A)}},[n,c,p,f]),l.jsx("div",{style:{height:348,overflow:"auto"},children:l.jsx(yt,{rowKey:A=>A._id_||A.name,scroll:{y:290},size:"small",dataSource:F,columns:[{title:c("base.form.name"),dataIndex:u,ellipsis:!0,width:100},{title:c("base.form.details"),ellipsis:!0,render:(A,b,T)=>{const E=j.includes(b)?I=>f(b.name,I||b):I=>p(b.name,I||b);let _;try{_=r(A,b,T)}catch{_=ft(A,b)}return l.jsx(de.Provider,{value:{update:E},children:_})}},{title:c("base.cmd.controls"),width:i?120:90,align:"right",dataIndex:u,render:(A,b,T)=>{const N=j.includes(b),E={...b};return delete E.status,l.jsxs(W,{size:2,children:[i?N?l.jsx(V,{title:c("base.cmd.disable"),icon:l.jsx(He,{style:{color:kt.primary}}),type:"link",size:"small",onClick:async()=>{await w(b)}}):l.jsx(V,{title:c("base.cmd.enabled"),type:"link",icon:l.jsx(Tt,{style:{color:jt.primary}}),size:"small",onClick:async()=>{await y(b)}}):null,l.jsx(V,{title:c("base.cmd.edit"),icon:l.jsx(xt,{}),type:"link",size:"small",onClick:()=>{Ee({title:c("title.edit",{name:A||""}),templates:O,initialValues:{value:te(E)},onFinish:async _=>{const{value:I}=_,B=Y(I);return N?await f(b.name,B):await p(b.name,{...E,...B}),!0}})}}),l.jsx(V,{title:c("base.cmd.copy"),icon:l.jsx(vt,{}),type:"link",size:"small",onClick:()=>{Ee({title:c("title.copied",{name:A||""}),templates:O,initialValues:{value:te(E)},onFinish:async _=>{const{value:I}=_,B=Y(I);return await x.addValue(B),!0}})}}),l.jsx(wt,{title:c("text.warn"),description:c("text.deleteing"),onConfirm:()=>{N?U(b):h(b)},children:l.jsx(V,{title:c("base.cmd.del"),icon:l.jsx(Lt,{}),type:"link",size:"small"})})]})}}],pagination:!1})})},Ie=le.show,rl={running:"gold",ready:"green",failed:"red"},cl=se.createContext({}),mt=(e,n,s)=>JSON.stringify(n),ul=(e,n)=>{var s,t;return((t=(s=e==null?void 0:e.name)==null?void 0:s.toLowerCase())==null?void 0:t.indexOf(n))!==-1},dl=e=>{const{name:n,title:s,api:t,localApi:i,keyName:o,rowKey:u="name",keyword:a,renderConfig:r=mt,filter:d=ul}=e,{t:c}=K(),{localList:m,comm:x}=g.useContext(we),{gostConfig:L,localConfig:k}=g.useContext(ie),{dataList:j,dataSource:v}=qe({localApi:i,name:o,gostConfig:L,localConfig:k}),O=We({name:o});bt.useApp();const{deleteValue:U,updateValue:f,disable:w,enable:y,updateLocal:p,deleteLocal:h,addValue:$}=x,S=g.useRef({dataList:j,dataSource:v});g.useImperativeHandle(S,()=>({dataList:j,dataSource:v}),[j,v]);const F=g.useMemo(()=>a?v.filter(A=>d(A,a)):v,[v,d,a]);return g.useEffect(()=>{function A({path:b,record:T}){const{dataList:N,dataSource:E}=S.current,_=N.includes(T),I=T.name,B=b.split(","),Le=B.reduce((D,Z)=>D==null?void 0:D[Z],T),Te=D=>{let Z=T;B.forEach((fe,Oe)=>{Oe===B.length-1?Z[fe]=D:Z=Z[fe]})};Ie({title:c("base.cmd.edit"),initialValues:{value:te(Le)},onFinish:async D=>(Te(Y(D.value)),_?await f(I,T):await p(I,T),!0)})}return R.on(`edit:${n}`,A),()=>{R.off(`edit:${n}`,A)}},[n,c,p,f]),l.jsx("div",{style:{height:348,overflow:"auto"},children:l.jsx(yt,{rowKey:A=>A._id_||A.name,scroll:{y:290},size:"small",dataSource:F,columns:[{title:c("base.form.name"),dataIndex:u,ellipsis:!0,width:150},{title:c("base.form.details"),ellipsis:!0,render:(A,b,T)=>{const E=j.includes(b)?I=>f(b.name,I||b):I=>p(b.name,I||b);let _;try{_=r(A,b,T)}catch{_=mt(A,b)}return l.jsx(cl.Provider,{value:{update:E},children:_})}},{title:c("base.form.status"),width:80,render:(A,b,T)=>{var _;const E=j.includes(b)?(_=b==null?void 0:b.status)==null?void 0:_.state:"disable";return E?l.jsx(X,{color:rl[E],children:E}):"-"}},{title:c("base.cmd.controls"),width:i?120:90,align:"right",dataIndex:u,render:(A,b,T)=>{const N=j.includes(b),E={...b};return delete E.status,l.jsxs(W,{size:2,children:[i?N?l.jsx(V,{title:c("base.cmd.disable"),icon:l.jsx(He,{style:{color:kt.primary}}),type:"link",size:"small",onClick:async()=>{await w(b)}}):l.jsx(V,{title:c("base.cmd.enabled"),type:"link",icon:l.jsx(Tt,{style:{color:jt.primary}}),size:"small",onClick:async()=>{await y(b)}}):null,l.jsx(V,{title:c("base.cmd.edit"),icon:l.jsx(xt,{}),type:"link",size:"small",onClick:()=>{Ie({title:c("title.edit",{name:A||""}),templates:O,initialValues:{value:te(E)},onFinish:async _=>{const{value:I}=_,B=Y(I);return N?await f(b.name,B):await p(b.name,{...E,...B}),!0}})}}),l.jsx(V,{title:c("base.cmd.copy"),icon:l.jsx(vt,{}),type:"link",size:"small",onClick:()=>{Ie({title:c("title.copied",{name:A||""}),templates:O,initialValues:{value:te(E)},onFinish:async _=>{const{value:I}=_,B=Y(I);return await x.addValue(B),!0}})}}),l.jsx(wt,{title:c("text.warn"),description:c("text.deleteing"),onConfirm:()=>{N?U(b):h(b)},children:l.jsx(V,{title:c("base.cmd.del"),icon:l.jsx(Lt,{}),type:"link",size:"small"})})]})}}],pagination:!1})})},fl={service:dl};function ml(e){return fl[e]||al}const Be=e=>{const{boxShadow:n,className:s,...t}=e,i=xe(s,{"antd-cord-boxShadow":n});return l.jsx(sn,{className:i,...t})},J=e=>{const{t:n}=K(),{title:s,subTitle:t,name:i,keyName:o,api:u,boxShadow:a=!0,bordered:r=!1,rowKey:d="name",renderConfig:c,localApi:m,filter:x}=g.useMemo(()=>({...il(e.module||""),title:n(`modules.${e.module}.title`),subTitle:n(`modules.${e.module}.subTitle`),...e}),[e,n]),[L,k]=g.useState(""),j={title:t||"",keyword:L,name:i,api:u,keyName:o,rowKey:d,localApi:m,renderConfig:c,filter:x},{gostConfig:v,localConfig:O}=g.useContext(ie),{dataSource:U}=qe({localApi:m,name:o,gostConfig:v,localConfig:O}),f=g.useMemo(()=>{const y=async p=>{await u.post(p)};return{updateValue:async(p,h,$=!0)=>{await u.put(p,h),$&&R.emit("apiUpdate",!0)},deleteValue:async(p,h=!0)=>{await u.delete(p.name),h&&R.emit("apiUpdate",!0)},addValue:async(p,h=!0)=>{let $=p.name||`${i}-0`;const S=()=>U==null?void 0:U.find(F=>F.name===$);if(S()&&!await new Promise((A,b)=>{Pe.confirm({title:n("msg.invalidName"),content:n("msg.autofixName"),zIndex:2e3,onOk:()=>A(!0),onCancel:()=>A(!1)})}))throw!1;for(;S();)$=$.replace(/\d*$/,F=>String(F==""?"-0":Number(F)+1));await y({...p,name:$}),p.name!==$&&ln.info({description:n("msg.fixName",{name:$}),message:n("msg.autofix")}),h&&R.emit("apiUpdate",!0)},disable:async p=>{m&&(await u.delete(p.name),await m.add(p),R.emit("update",!0))},enable:async p=>{m&&(await u.post(p),await m.delete(p.name),R.emit("update",!0))},updateLocal:async(p,h)=>{m&&(await m.put(p,{...h,name:p}),R.emit("localUpdate"))},deleteLocal:async p=>{m&&(await m.delete(p.name),R.emit("localUpdate"))}}},[u,U,m,i,n]);g.useEffect(()=>Pt(i,f),[f,i]);const w=g.useMemo(()=>{debugger;return ml(e.module)},[e.module]);return l.jsx(we.Provider,{value:{name:i,comm:f},children:l.jsx(Be,{boxShadow:a,bordered:r,title:s,extra:l.jsxs(W,{children:[l.jsx(De.Search,{allowClear:!0,onChange:y=>{const p=y.target.value;k(p)},size:"small"}),l.jsx(sl,{...j})]}),children:l.jsx(w,{...j})})})},pl=e=>{var a,r,d;const{name:n,addr:s}=e,t=(a=e.connector)==null?void 0:a.type,i=(r=e.dialer)==null?void 0:r.type,o=((d=e.connector)==null?void 0:d.metadata)||e.metadata,u=o?Ht.stringify(o):"";return l.jsxs(W,{children:[(t||i)&&l.jsx(X,{color:"#87d068",children:`${t}${i?"+"+i:""}`}),l.jsx(X,{color:"green",children:s}),u&&l.jsx(X,{color:"purple",title:"_metadata",children:"metadata"})]})};function Me({node:e,upjson:n}){const{t:s}=K(),{name:t}=e,{update:i}=g.useContext(de),o=g.useMemo(()=>n?{className:"editor-json",onDoubleClick:()=>{le.show({title:s("base.cmd.edit"),initialValues:{value:te(e)},onFinish:async u=>(n(Y(u.value)),i(),!0)})}}:{},[e,s,i,n]);return l.jsx(he,{color:"#ddffbf",title:l.jsx(pl,{...e}),children:l.jsx(X,{bordered:!1,color:"green",title:s("text.doubleClickEdit"),...o,children:t})})}const Ft=e=>{var u;let n=e,s=!1;const{gostConfig:t,localConfig:i}=g.useContext(ie);if(!n.nodes){const a=[...(t==null?void 0:t.hops)||[],...(i==null?void 0:i.hops)||[]].find(r=>r.name===n.name);a&&(s=!0,n=a)}const{nodes:o}=n;if(!o||(o==null?void 0:o.length)<=0)return`[${e.name}(noNodes)]`;if(s){const a=(u=t==null?void 0:t.hops)==null?void 0:u.includes(n),r=n.name;return l.jsx(de.Provider,{value:{update:async d=>{const c=await Re("hop");return(a?x=>c.updateValue(r,x||n):x=>c.updateLocal(r,x||n))(d)}},children:l.jsx(W,{size:5,children:o.map((d,c)=>l.jsx(Me,{node:d,upjson:m=>o[c]=m},c))})})}return l.jsx(W,{size:5,children:o.map((a,r)=>l.jsx(Me,{node:a,upjson:d=>o[r]=d},a.name+r))})};function hl(e){const{update:n}=g.useContext(de),{t:s}=K();return l.jsx(W,{size:5,children:e.hops.map((t,i)=>{const o=l.jsx(Ft,{...t});return l.jsx(he,{title:o,color:"#c7e7ff",arrow:!1,children:l.jsx(X,{bordered:!1,color:"blue",className:"editor-json",title:s("text.doubleClickEdit"),onDoubleClick:()=>{le.show({title:s("base.cmd.edit"),initialValues:{value:te(t)},onFinish:async u=>(e.hops[i]=Y(u.value),n(),!0)})},children:t.name})},t.name+i)}).reduce((t,i,o)=>(t.length>0&&t.push(l.jsx(on,{style:{color:"blue",fontSize:12}},"_sp_"+o)),t.push(i),t),[])})}function Vt(e){const{hops:n}=e;return l.jsx(hl,{hops:n,root:e})}const gl=e=>{g.useContext(ie);const n={module:"chain",renderConfig:(s,t,i)=>l.jsx(Vt,{...t})};return l.jsx(J,{...n})},zt=(e,n)=>{const{gostConfig:s,localConfig:t}=g.useContext(ie),i=g.useMemo(()=>{var a;return(a=s==null?void 0:s[n])==null?void 0:a.find(r=>r.name===e)},[s,e,n]),o=g.useMemo(()=>{var a;return(a=t==null?void 0:t[n])==null?void 0:a.find(r=>r.name===e)},[t,e,n]);return[i??o,!!i]},bl=e=>{const[n,s]=zt(e.hop,"hops");let t=e,i=!1;(!t.nodes||t.nodes.length===0)&&(t=n,i=!!n);const{nodes:o}=t;if(!o||(o==null?void 0:o.length)<=0)return`[${e.name}(noNodes)]`;const u=l.jsx(W,{size:5,children:o.map((a,r)=>l.jsx(Me,{node:a,upjson:d=>o[r]=d},a.name+r))});if(i){const a=t.name;return l.jsx(de.Provider,{value:{update:async r=>{const d=await Re("hop");return(s?m=>d.updateValue(a,m||t):m=>d.updateLocal(a,m||t))(r)}},children:u})}return u},pt=e=>{const[n,s]=zt(e.chainName,"chains");if(!n)return"[no chain]";const t=e.chainName;return l.jsx(de.Provider,{value:{update:async i=>{const o=await Re("chain");return(s?a=>o.updateValue(t,a||n):a=>o.updateLocal(t,a||n))(i)}},children:l.jsx(Vt,{...n})})},yl=e=>{const{name:n,addr:s,handler:t,listener:i,forwarder:o}=e,{t:u}=K(),a=g.useMemo(()=>{const r=t==null?void 0:t.type,d=i==null?void 0:i.type;return r===d?r:`${r}+${d}`},[t,i]);return l.jsxs(W,{children:[l.jsx(X,{color:"#87d068",children:a}),l.jsx(X,{color:"green",children:s}),t.chain&&l.jsx(he,{title:l.jsx(pt,{chainName:t.chain}),color:"#c7e7ff",arrow:!1,children:l.jsx(X,{children:u("modules.chain.subTitle")})}),i.chain&&l.jsx(he,{title:l.jsx(pt,{chainName:i.chain}),color:"#fff0d7",arrow:!1,children:l.jsx(X,{color:"orange",children:u("terms.key0")})}),o&&l.jsx(he,{title:l.jsx(bl,{...o}),color:"#c7e7ff",arrow:!1,children:l.jsx(X,{children:u("terms.forwarder")})})]})},kl=e=>{const{colSpan:n}=e;ht();const s={module:"service",renderConfig:(t,i,o)=>l.jsx(yl,{...i}),filter:(t,i)=>{const{name:o,addr:u,handler:a,listener:r}=t;function d(c){const m=c==null?void 0:c.toLowerCase();return m?m.indexOf(i)!==-1:!1}return d(o)||d(u)||d(a==null?void 0:a.type)||d(r==null?void 0:r.type)}};return l.jsx(z,{...n,xxl:16,children:l.jsx(J,{...s})})},jl=e=>l.jsx(J,{module:"hop",renderConfig:(n,s,t)=>l.jsx(Ft,{...s})}),Q={xs:24,sm:24,md:12,lg:12,xl:12,xxl:8},_e={sm:24,xxl:8},$l=()=>{const{isLoading:e}=g.useContext(ie),n=be(),{t:s}=K(),t=ht(),[i,o]=g.useState(!1),[u,a]=g.useState(!1),[r,d]=g.useState(!0),[c,m]=g.useState([]),x=g.useRef({});g.useEffect(()=>{Jt().then(k=>k.sort((j,v)=>{const O=j.time||0;return(v.time||0)-O})).then(k=>m(k.map(j=>({key:j.addr,label:l.jsx("a",{href:`./?use=${j.addr}`,children:j.addr})}))))},[n.addr]),g.useEffect(()=>{Wt().then(v=>{v&&R.emit("update",!1)});const k=x.current.onSave=async()=>{try{a(!0);const{saveFormat:v,savePath:O}=be.get()||{};await qt(v,O),d(!0)}finally{a(!1)}},j=(v=!1)=>{var O;if(v&&d(!1),!(!((O=be.get())!=null&&O.autoSave)||!v))return k()};return R.on("update",j),R.on("apiUpdate",j),()=>{R.off("update",j),R.off("apiUpdate",j)}},[]);const L=g.useMemo(()=>{const k=[];return c.length&&(k.push({key:"2",label:s("manage.cmd.switch"),children:c}),k.push({type:"divider"})),k.push({key:"new",label:s("manage.cmd.new"),onClick:()=>{window.open(location.href,void 0,"noopener")}}),k},[c,s]);return l.jsxs(Ae,{style:{height:"100vh",overflow:"hidden"},children:[l.jsxs(Ae.Header,{style:{color:"#FFF",paddingInline:20},children:[l.jsxs($e,{align:"middle",justify:"space-between",wrap:!1,children:[l.jsx(z,{color:"",children:l.jsx(V,{type:"link",loading:e,icon:l.jsx(an,{}),onClick:async()=>{R.emit("update")},children:s("manage.cmd.reload")})}),l.jsx(z,{children:n.addr}),l.jsx(z,{children:l.jsxs(W,{children:[l.jsxs(W.Compact,{children:[l.jsx(V,{icon:r?l.jsx(He,{}):l.jsx($n,{}),loading:u,onClick:()=>{var k,j;return(j=(k=x.current)==null?void 0:k.onSave)==null?void 0:j.call(k)},children:s("manage.cmd.save")}),l.jsx(V,{icon:l.jsx(_n,{}),onClick:()=>o(!0)})]}),l.jsx(V,{icon:l.jsx(rn,{}),onClick:()=>{Yn(ze(t),"gost.json")},children:s("manage.cmd.download")}),l.jsx(gt.Button,{menu:{activeKey:n.addr,items:L},onClick:Zt,children:s("manage.cmd.logout")}),l.jsx(Gt,{}),l.jsx(Qt,{})]})})]}),l.jsx(Pe,{destroyOnClose:!0,open:i,onCancel:()=>o(!1),footer:!1,children:l.jsxs(ee,{initialValues:n,layout:"horizontal",labelCol:{span:4},onValuesChange:(k,j)=>{Object.assign(n,k),be.set(n),n.isLocal&&Xt(n.addr,n)},children:[l.jsx(ee.Item,{name:"autoSave",label:s("manage.label.autoSave"),valuePropName:"checked",children:l.jsx(cn,{})}),l.jsx(ee.Item,{name:"saveFormat",label:s("manage.label.format"),initialValue:"json",children:l.jsxs(Ue.Group,{optionType:"button",buttonStyle:"solid",children:[l.jsx(Ue,{value:"json",children:"json"}),l.jsx(Ue,{value:"yaml",children:"yaml"})]})}),l.jsx(ee.Item,{name:"savePath",label:s("manage.label.path"),trigger:"onChange",children:l.jsx(De,{placeholder:s("placeholder.savePath")})})]})})]}),l.jsx(Ae.Content,{style:{height:"100%",padding:16,boxSizing:"border-box",overflow:"auto"},children:l.jsxs($e,{gutter:[16,16],children:[l.jsx(kl,{colSpan:Q}),l.jsx(z,{...Q,children:l.jsx(gl,{})}),l.jsx(z,{...Q,children:l.jsx(jl,{})}),l.jsx(z,{...Q,children:l.jsx(J,{module:"auther"})}),l.jsx(z,{...Q,children:l.jsx(J,{module:"admission"})}),l.jsx(z,{...Q,children:l.jsx(J,{module:"bypass"})}),l.jsx(z,{...Q,children:l.jsx(J,{module:"host"})}),l.jsx(z,{...Q,children:l.jsx(J,{module:"ingress"})}),l.jsx(z,{...Q,children:l.jsx(J,{module:"resolver"})}),l.jsx(z,{...Q,children:l.jsx(J,{module:"sd"})}),l.jsx(z,{...Q,children:l.jsx(J,{module:"observer"})}),l.jsx(z,{span:24,children:l.jsx(Be,{boxShadow:!0,title:s("manage.label.limit"),children:l.jsxs($e,{gutter:[16,16],children:[l.jsx(z,{..._e,children:l.jsx(J,{module:"limiter",bordered:!0,boxShadow:!1})}),l.jsx(z,{..._e,children:l.jsx(J,{module:"rlimiter",bordered:!0,boxShadow:!1})}),l.jsx(z,{..._e,children:l.jsx(J,{module:"climiter",bordered:!0,boxShadow:!1})})]})})}),l.jsx(z,{span:24,children:l.jsx(Be,{boxShadow:!0,title:s("manage.label.allConfig"),styles:{body:{padding:20}},children:l.jsx(St,{className:"g-boder",value:ze(t),height:500,language:"json",options:{minimap:{enabled:!1},readOnly:!0}})})})]})})]})};export{$l as default};
